import{A as I}from"./AdminLayout-1d3700ae.js";import{H as D,L as V,M as H,b as a,o as l,c as u,g as _,w as h,F as k,e as t,A as d,i as b,K as f,G as T,C as B,f as M,J as E,D as F,d as j}from"./app-b9f46dc5.js";import q from"./CommentNode-e683f7cb.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import"./logo-c37a058e.js";const G={components:{AdminLayout:I,Head:D,CommentNode:q,Link:V},props:{forumId:Number},data(){return{commentText:"",replyingTo:null,highlightedCommentId:null,forum:null,canAction:!1}},created(){window.Echo.channel("store_comment").listen(".store_comment",o=>{this.forum.comments.unshift(o.comment)}),this.loadComments()},mounted(){const o=window.location.hash;if(o.startsWith("#comment-")){const s=parseInt(o.replace("#comment-",""),10);isNaN(s)||(this.highlightedCommentId=s)}},computed:{rootComments(){return this.forum.comments.filter(o=>!o.comment_id)}},methods:{toggleStatus(){Swal.fire({title:this.forum.is_done?"Форумды қайта ашқыңыз келе ме?":"Форумды жабқыңыз келе ме?",icon:"question",showCancelButton:!0,confirmButtonText:this.forum.is_done?"Иә, қайта ашу":"Иә, жабу",cancelButtonText:"Жоқ"}).then(o=>{o.isConfirmed&&H.Inertia.put(route("admin.forums.toggleStatus",this.forum.id),{},{onSuccess:()=>{}})})},deleteData(o){Swal.fire({title:"Жоюға сенімдісіз бе?",text:"Қайтып қалпына келмеуі мүмкін!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Иә, жоямын!",cancelButtonText:"Жоқ"}).then(s=>{s.isConfirmed&&this.$inertia.delete(route("admin.forums.destroy",o))})},async loadComments(){await axios.post(`/admin/forums/${this.forumId}/comments`).then(o=>{this.forum=o.data.forum,this.canAction=o.data.canAction})},submitComment(){axios.post(`/admin/forums/${this.forum.id}/commentstore`,{comment:this.commentText,comment_id:null}).then(o=>{this.forum.comments.unshift(o.data.forumComment),this.commentText=""})}}},J={class:"row mb-2"},K={class:"col-sm-6"},U={class:"fw-bold text-dark mb-0"},W=t("i",{class:"fas fa-user-shield text-primary me-2"},null,-1),O={class:"col-sm-6"},P={class:"breadcrumb float-sm-end"},Q={class:"breadcrumb-item"},R=["href"],X=t("i",{class:"fas fa-dashboard"},null,-1),Y=b(" Басты бет"),Z=[X,Y],$={class:"breadcrumb-item"},tt=["href"],et=t("i",{class:"fas fa-dashboard"},null,-1),ot=b(" Форумдар тізімі"),st=[et,ot],nt={class:"breadcrumb-item active"},it={class:"container mt-4"},mt={class:"card mb-4"},ct={class:"card-body d-flex align-items-center justify-content-between"},rt={class:"card-title mr-1 d-inline-block"},lt={key:0,class:"btn-group mt-3 mt-md-0"},dt=t("i",{class:"fas fa-edit"},null,-1),at=t("i",{class:"fas fa-trash-alt"},null,-1),ut=[at],ht=["title"],_t={class:"card"},ft={class:"card-body"},bt={class:"mb-3"},pt=["disabled"],gt=["disabled"],Ct={key:0,class:"mb-4"},xt=t("h4",{class:"mb-3"},"Жауаптар",-1);function wt(o,s,vt,yt,e,m){const N=a("Head"),S=a("Link"),A=a("CommentNode"),L=a("AdminLayout");return l(),u(k,null,[_(N,null,{default:h(()=>{var n;return[t("title",null,"Админ панель | "+d((n=e.forum)==null?void 0:n.title)+" форумы",1)]}),_:1}),_(L,null,{breadcrumbs:h(()=>{var n,c;return[t("div",J,[t("div",K,[t("h2",U,[W,b(" "+d((n=e.forum)==null?void 0:n.title)+" форумы ",1)])]),t("div",O,[t("ol",P,[t("li",Q,[t("a",{href:o.route("admin.index")},Z,8,R)]),t("li",$,[t("a",{href:o.route("admin.forums.index")},st,8,tt)]),t("li",nt,d((c=e.forum)==null?void 0:c.title)+" форумы",1)])])])]}),default:h(()=>{var n,c,p,g,C,x,w,v;return[t("div",it,[t("div",mt,[t("div",ct,[t("div",null,[t("div",rt,d((n=e.forum)==null?void 0:n.title),1),t("span",{class:f(["badge",(c=e.forum)!=null&&c.is_done?"bg-success":"bg-warning text-dark"])},d((p=e.forum)!=null&&p.is_done?"Жабылды":"Жауабын күтуде"),3)]),e.canAction?(l(),u("div",lt,[_(S,{href:o.route("admin.forums.edit",e.forum),class:"btn btn-outline-primary btn-sm",title:"Өзгерту"},{default:h(()=>[dt]),_:1},8,["href"]),t("button",{onClick:s[0]||(s[0]=T(i=>{var r;return m.deleteData((r=e.forum)==null?void 0:r.id)},["prevent"])),class:"btn btn-outline-danger btn-sm",title:"Жою"},ut),t("button",{onClick:s[1]||(s[1]=(...i)=>m.toggleStatus&&m.toggleStatus(...i)),class:f(["btn btn-sm",(g=e.forum)!=null&&g.is_done?"btn-outline-warning":"btn-outline-success"]),title:(C=e.forum)!=null&&C.is_done?"Форумды қайта ашу":"Форумды жабу"},[t("i",{class:f((x=e.forum)!=null&&x.is_done?"fas fa-lock text-success":"fas fa-lock-open text-warning")},null,2)],10,ht)])):B("",!0)])]),t("div",_t,[t("div",ft,[t("form",{onSubmit:s[3]||(s[3]=T(i=>m.submitComment(),["prevent"]))},[t("div",bt,[M(t("textarea",{"onUpdate:modelValue":s[2]||(s[2]=i=>e.commentText=i),rows:"4",class:"form-control",placeholder:"Жауап жазу...",disabled:(w=e.forum)==null?void 0:w.is_done},null,8,pt),[[E,e.commentText]])]),t("button",{type:"submit",class:"btn btn-primary",disabled:!e.commentText.trim()}," Жіберу ",8,gt)],32)])]),(v=e.forum)!=null&&v.comments.length?(l(),u("div",Ct,[xt,(l(!0),u(k,null,F(m.rootComments,i=>{var r,y;return l(),j(A,{key:i.id,comment:i,is_done:(r=e.forum)==null?void 0:r.is_done,"all-comments":(y=e.forum)==null?void 0:y.comments,"highlighted-id":e.highlightedCommentId},null,8,["comment","is_done","all-comments","highlighted-id"])}),128))])):B("",!0)])]}),_:1})],64)}const At=z(G,[["render",wt]]);export{At as default};
