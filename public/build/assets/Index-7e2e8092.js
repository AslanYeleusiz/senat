import{A as f}from"./AdminLayout-1d3700ae.js";import{L as b,H as x,b as p,o as i,c as n,e as t,A as r,g as v,w as u,F as c,i as l,f as y,I as k,D as g,C as m}from"./app-b9f46dc5.js";import{_ as w}from"./_plugin-vue_export-helper-c27b6911.js";import"./logo-c37a058e.js";const C={components:{AdminLayout:f,Link:b,Head:x},props:["notifications"],data(){return{filter:{status:route().params.status?route().params.status:"all"},loading:0}},methods:{formatDate(e){if(!e)return"";const o={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleString("ru-RU",o)},async markAsRead(e){try{await axios.post(`/admin/notifications/${e}/read`),window.location.reload()}catch(o){console.error("Ошибка при пометке уведомления как прочитанного:",o)}},formatTitle(e){return e.replace(/<a .*<\/a>/,"").trim()||"Уведомление"},extractLink(e){const o=e.match(/<a href=['"]([^'"]+)['"]/);return o?o[1]:null},isStructuredText(e){return e.includes(":")},extractAuthor(e){return e.split(":")[0]},extractComment(e){return e.split(":").slice(1).join(":").trim()},deleteData(e){Swal.fire({title:"Жоюға сенімдісіз бе?",text:"Қайтып қалпына келмеуі мүмкін!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Иә, жоямын!",cancelButtonText:"Жоқ"}).then(o=>{o.isConfirmed&&this.$inertia.delete(route("admin.notifications.destroy",e))})},removeFilter(e){this.filter[e]=null,this.search()},search(){this.loading=1;const e=this.clearParams(this.filter);this.$inertia.get(route("admin.notifications.index"),e)}},computed:{activeFilters(){const e=[];return this.filter.title&&e.push({key:"title",value:this.filter.title}),e}}},L={class:"row mb-2"},A={class:"col-sm-6"},T={class:"fw-bold text-dark mb-0"},B=t("i",{class:"fas fa-user-shield text-primary me-2"},null,-1),D={class:"col-sm-6"},S={class:"breadcrumb float-sm-right"},V={class:"breadcrumb-item"},F=["href"],H=t("i",{class:"fas fa-dashboard"},null,-1),N=l(" Басты бет "),I=[H,N],M={class:"breadcrumb-item active"},R={class:"container-fluid"},U={class:"row mb-4"},j={class:"col-md-4"},E=t("label",{class:"form-label fw-bold"},"Фильтр по статусу:",-1),P=t("option",{value:"all"},"Все",-1),q=t("option",{value:"unread"},"Непрочитанные",-1),z=t("option",{value:"read"},"Прочитанные",-1),G=[P,q,z],J={key:0,class:"row"},K={class:"card shadow-sm rounded-4 border-0"},O={class:"card-body"},Q={class:"text-muted position-absolute top-0 end-0 p-3"},W={class:"fw-semibold text-primary mb-3"},X={class:"mb-1"},Y=t("strong",null,"Автор:",-1),Z={class:"mb-2"},$=t("strong",null,"Написал:",-1),tt=["innerHTML"],et={class:"d-flex gap-2 mt-3"},st=["href"],ot=["onClick"],at={key:1,class:"alert alert-info text-center mt-4"};function it(e,o,d,nt,_,a){const h=p("AdminLayout");return i(),n(c,null,[t("head",null,[t("title",null,"Админ панель | "+r(e.__("Хабарламалар")),1)]),v(h,null,{breadcrumbs:u(()=>[t("div",L,[t("div",A,[t("h2",T,[B,l(" "+r(e.__("Хабарламалар")),1)])]),t("div",D,[t("ol",S,[t("li",V,[t("a",{href:e.route("admin.index")},I,8,F)]),t("li",M,r(e.__("Хабарламалар")),1)])])])]),default:u(()=>[t("div",R,[t("div",U,[t("div",j,[E,y(t("select",{"onUpdate:modelValue":o[0]||(o[0]=s=>_.filter.status=s),onChange:o[1]||(o[1]=(...s)=>a.search&&a.search(...s)),class:"form-select"},G,544),[[k,_.filter.status]])])]),d.notifications.length?(i(),n("div",J,[(i(!0),n(c,null,g(d.notifications,s=>(i(),n("div",{key:"notification-"+s.id,class:"col-12 mb-3"},[t("div",K,[t("div",O,[t("small",Q,r(s.notification.created_at_human),1),t("h5",W,r(a.formatTitle(s.notification.title)),1),a.isStructuredText(s.notification.text)?(i(),n(c,{key:0},[t("p",X,[Y,l(" "+r(a.extractAuthor(s.notification.text)),1)]),t("p",Z,[$,l(' "'+r(a.extractComment(s.notification.text))+'" ',1)])],64)):(i(),n("p",{key:1,class:"text-dark mb-2",innerHTML:s.notification.text},null,8,tt)),t("div",et,[a.extractLink(s.notification.title)?(i(),n("a",{key:0,href:a.extractLink(s.notification.title),class:"btn btn-outline-primary btn-sm",target:"_blank"}," Перейти ",8,st)):m("",!0),s.read_at?m("",!0):(i(),n("button",{key:1,onClick:rt=>a.markAsRead(s.id),class:"btn btn-outline-secondary btn-sm"}," Пометить как прочитанное ",8,ot))])])])]))),128))])):(i(),n("div",at," Жаңа хабарлама жоқ. "))])]),_:1})],64)}const ut=w(C,[["render",it]]);export{ut as default};
